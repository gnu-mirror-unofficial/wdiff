<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This file documents the wdiff command, which compares two files,
finding which words have been deleted or added to the first for getting
the second.
It also documents some other diff related tools.

Copyright (C) 1992, 1994, 1997, 1998, 1999, 2010, 2011, 2012,
2013 Free Software Foundation, Inc.

Permission is granted to make and distribute verbatim copies of
this manual provided the copyright notice and this permission notice
are preserved on all copies.

Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the entire
resulting derived work is distributed under the terms of a permission
notice identical to this one.

Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions,
except that this permission notice may be stated in a translation approved
by the Foundation. -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->
<head>
<title>A word difference finder (and others)</title>

<meta name="description" content="A word difference finder (and others)">
<meta name="keywords" content="A word difference finder (and others)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="#Top" rel="start" title="Top">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="dir.html#Top" rel="up" title="(dir)">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.indentedblock {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
div.smalllisp {margin-left: 3.2em}
kbd {font-style:oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:nowrap}
span.nolinebreak {white-space:nowrap}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">
<h1 class="settitle" align="center">A word difference finder (and others)</h1>





<a name="Top"></a>
<div class="header">
<p>
Next: <a href="#Overview" accesskey="n" rel="next">Overview</a>, Up: <a href="dir.html#Top" accesskey="u" rel="up">(dir)</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="GNU-wdiff"></a>
<h1 class="top">GNU wdiff</h1>

<p>These Info pages document <code>wdiff</code>, a word difference finder, together
with some other <code>diff</code> related tools.
Note that some tools documented here are considered experimental and may
not be part of every <code>wdiff</code> installation.
See <a href="#Experimental">Experimental</a>.
</p>
<p>This is for release 1.2.2.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Overview" accesskey="1">Overview</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Overview
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#wdiff" accesskey="2">wdiff</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">The word difference finder </td></tr>
<tr><td align="left" valign="top">&bull; <a href="#mdiff" accesskey="3">mdiff</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">The line cluster finder
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#unify" accesskey="4">unify</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">The diff format converter
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Compatibility" accesskey="5">Compatibility</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">How <code>mdiff</code> differs
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Experimental" accesskey="6">Experimental</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">About experimental programs
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
</pre></th></tr><tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
&mdash; The Detailed Node Listing &mdash;

The word difference finder

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#wdiff-invocation" accesskey="7">wdiff invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Invoking <code>wdiff</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#wdiff-Examples" accesskey="8">wdiff Examples</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Actual examples of <code>wdiff</code> usage
The multi-difference finder
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#mdiff-invocation" accesskey="9">mdiff invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Invoking <code>mdiff</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Efficiency">Efficiency</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Resource considerations and efficiency
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
The diff format converter

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#unify-invocation">unify invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Invoking <code>unify</code>
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
How <code>mdiff</code> differs

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#diff-Compatibility">diff Compatibility</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Differences with <code>diff</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#wdiff-Compatibility">wdiff Compatibility</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Differences with <code>wdiff</code>
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
Experimental programs

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Experimental-History">Experimental History</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">History of the experimental programs
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
</pre></th></tr></table>


<a name="SEC_Contents"></a>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">

<ul class="no-bullet">
  <li><a name="toc-Overview-1" href="#Overview">1 Overview</a></li>
  <li><a name="toc-The-word-difference-finder" href="#wdiff">2 The word difference finder</a>
  <ul class="no-bullet">
    <li><a name="toc-Invoking-wdiff" href="#wdiff-invocation">2.1 Invoking <code>wdiff</code></a></li>
    <li><a name="toc-Actual-examples-of-wdiff-usage" href="#wdiff-Examples">2.2 Actual examples of <code>wdiff</code> usage</a></li>
  </ul></li>
  <li><a name="toc-The-multi_002ddifference-finder" href="#mdiff">3 The multi-difference finder</a>
  <ul class="no-bullet">
    <li><a name="toc-Invoking-mdiff" href="#mdiff-invocation">3.1 Invoking <code>mdiff</code></a></li>
    <li><a name="toc-Resource-considerations-and-efficiency" href="#Efficiency">3.2 Resource considerations and efficiency</a></li>
  </ul></li>
  <li><a name="toc-The-diff-format-converter" href="#unify">4 The diff format converter</a>
  <ul class="no-bullet">
    <li><a name="toc-Invoking-unify" href="#unify-invocation">4.1 Invoking <code>unify</code></a></li>
  </ul></li>
  <li><a name="toc-How-mdiff-differs" href="#Compatibility">5 How <code>mdiff</code> differs</a>
  <ul class="no-bullet">
    <li><a name="toc-Differences-with-diff" href="#diff-Compatibility">5.1 Differences with <code>diff</code></a></li>
    <li><a name="toc-Differences-with-wdiff" href="#wdiff-Compatibility">5.2 Differences with <code>wdiff</code></a></li>
  </ul></li>
  <li><a name="toc-Experimental-programs" href="#Experimental">6 Experimental programs</a>
  <ul class="no-bullet">
    <li><a name="toc-History-of-the-Experimental-programs" href="#Experimental-History">6.1 History of the Experimental programs</a></li>
  </ul></li>
</ul>
</div>


<hr>
<a name="Overview"></a>
<div class="header">
<p>
Next: <a href="#wdiff" accesskey="n" rel="next">wdiff</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Overview-1"></a>
<h2 class="chapter">1 Overview</h2>

<p><code>wdiff</code> is a front end to <code>diff</code> for comparing files on
a word per word basis. It works by creating two temporary files, one
word per line, and then executes <code>diff</code> on these files. It collects the
<code>diff</code> output and uses it to produce a nicer display of word differences
between the original files.
</p>

<p><code>mdiff</code> studies one or more input files altogether, and discovers
blocks of items which repeat at more than one place.  Items may be lines,
words, or units defined by user.  When in word mode, <code>mdiff</code> compares
two files, finding which words have been deleted or added to the first
in order to create the second, which is useful when two texts differ
only by a few words and paragraphs have been refilled.  The program has
many output formats and interacts well with terminals and pagers (notably
with <code>less</code>).
</p>
<p><code>unify</code> is able to convert context diffs to unidiff format, or the
other way around.  Some people just prefer one format and despise the
other, it is a religious issue.  This program brings peace back to Earth.
</p>
<p><code>wdiff2</code> is intended as a replacement to <code>wdiff</code>.
It aims at supporting the same set of options, but uses <code>mdiff</code>
instead of <code>diff</code> as its backend.
</p>
<p><code>wdiff</code>, <code>mdiff</code> and <code>wdiff2</code>
were written by Fran&ccedil;ois Pinard, while
<code>unify</code> has been contributed by Wayne Davison.
Please report bugs to <a href="mailto:wdiff-bugs@gnu.org">wdiff-bugs@gnu.org</a>.
Include the version number, which
you can find by running the program with <samp>--version</samp>.  Please include
in your message sufficient input to reproduce what you got, the output you
indeed expected, and careful explanations about the nature of the problem.
</p>
<hr>
<a name="wdiff"></a>
<div class="header">
<p>
Next: <a href="#mdiff" accesskey="n" rel="next">mdiff</a>, Previous: <a href="#Overview" accesskey="p" rel="prev">Overview</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="The-word-difference-finder"></a>
<h2 class="chapter">2 The word difference finder</h2>

<p>There are actually two programs for comparing files on a word per word
basis.
<code>wdiff</code> is a front-end to <code>diff</code> as found in the
GNU diffutils package. It is quite mature.
Its planned successor, <code>wdiff2</code>, is a front end to <code>mdiff</code>,
and as experimental as <code>mdiff</code> itself.
See <a href="#Experimental">Experimental</a>.
</p>
<p>A word is anything between whitespace.  This is useful for comparing two
texts in which a few words have been changed and for which paragraphs
have been refilled.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#wdiff-invocation" accesskey="1">wdiff invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Invoking <code>wdiff</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#wdiff-Examples" accesskey="2">wdiff Examples</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Actual examples of <code>wdiff</code> usage
</td></tr>
</table>

<hr>
<a name="wdiff-invocation"></a>
<div class="header">
<p>
Next: <a href="#wdiff-Examples" accesskey="n" rel="next">wdiff Examples</a>, Up: <a href="#wdiff" accesskey="u" rel="up">wdiff</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Invoking-wdiff"></a>
<h3 class="section">2.1 Invoking <code>wdiff</code></h3>

<p>The programs <code>wdiff</code> and <code>wdiff2</code> aim at providing the
same set of command line options. They are described below.
See <a href="#wdiff-Compatibility">wdiff Compatibility</a>, for a list of differences.
</p>
<div class="example">
<pre class="example">wdiff <var>option</var> &hellip; <var>old_file</var> <var>new_file</var>
wdiff <var>option</var> &hellip; -d [<var>diff_file</var>]
</pre></div>

<p><code>wdiff</code> compares files <var>old_file</var> and <var>new_file</var> and
produces an annotated copy of <var>new_file</var> on standard output.  The
empty string or the string &lsquo;<samp>-</samp>&rsquo; denotes standard input, but standard
input cannot be used twice in the same invocation.  The complete path of
a file should be given, a directory name is not accepted.  <code>wdiff</code>
will exit with a status of 0 if no differences were found, a status of 1
if any differences were found, or a status of 2 for any error.
</p>
<p>In this documentation, <em>deleted text</em> refers to text in
<var>old_file</var> which is not in <var>new_file</var>, while <em>inserted text</em>
refers to text on <var>new_file</var> which is not in <var>old_file</var>.
</p>
<p><code>wdiff</code> supports the following command line options:
</p>
<dl compact="compact">
<dt><samp>--help</samp></dt>
<dt><samp>-h</samp></dt>
<dd><p>Print an informative help message describing the options.
</p>
</dd>
<dt><samp>--version</samp></dt>
<dt><samp>-v</samp></dt>
<dd><p>Print the version number of <code>wdiff</code> on the standard error output.
</p>
</dd>
<dt><samp>--no-deleted</samp></dt>
<dt><samp>-1</samp></dt>
<dd><p>Avoid producing deleted words on the output.  If neither <samp>-1</samp> or
<samp>-2</samp> is selected, the original right margin may be exceeded for
some lines.
</p>
</dd>
<dt><samp>--no-inserted</samp></dt>
<dt><samp>-2</samp></dt>
<dd><p>Avoid producing inserted words on the output.  When this flag is given,
the whitespace in the output is taken from <var>old_file</var> instead of
<var>new_file</var>.  If neither <samp>-1</samp> or <samp>-2</samp> is selected, the
original right margin may be exceeded for some lines.
</p>
</dd>
<dt><samp>--no-common</samp></dt>
<dt><samp>-3</samp></dt>
<dd><p>Avoid producing common words on the output.  When this option is not
selected, common words and whitespace are taken from <var>new_file</var>,
unless option <samp>-2</samp> is given, in which case common words and
whitespace are rather taken from <var>old_file</var>.  When selected,
differences are separated from one another by lines of dashes.
Moreover, if this option is selected at the same time as <samp>-1</samp> or
<samp>-2</samp>, then none of the output will have any emphasis, i.e. no bold
or underlining.  Finally, if this option is not selected, but both
<samp>-1</samp> and <samp>-2</samp> are, then sections of common words between
differences are segregated by lines of dashes.
</p>
</dd>
<dt><samp>--ignore-case</samp></dt>
<dt><samp>-i</samp></dt>
<dd><p>Do not consider case difference while comparing words.  Each lower case
letter is seen as identical to its upper case equivalent for the purpose
of deciding if two words are the same.
</p>
</dd>
<dt><samp>--statistics</samp></dt>
<dt><samp>-s</samp></dt>
<dd><p>On completion, for each file, the total number of words, the number of
common words between the files, the number of words deleted or inserted
and the number of words that have changed is output.  (A changed word is
one that has been replaced or is part of a replacement.)  Except for the
total number of words, all of the numbers are followed by a percentage
relative to the total number of words in the file.
</p>
</dd>
<dt><samp>--auto-pager</samp></dt>
<dt><samp>-a</samp></dt>
<dd><p>Some initiatives which were previously automatically taken in previous
versions of <code>wdiff</code> are now put under the control of this option.
By using it, a pager is interposed whenever the <code>wdiff</code> output is
directed to the user&rsquo;s terminal.  Without this option, no pager will be
called, the user is then responsible for explicitly piping <code>wdiff</code>
output into a pager, if required.
</p>
<p>The pager is selected by the value of the <var>PAGER</var> environment
variable when <code>wdiff</code> is run.  If <var>PAGER</var> is not defined at
run time, then a default pager, selected at installation time, will be
used instead.  A defined but empty value of <var>PAGER</var> means no pager
at all.
</p>
<p>When a pager is interposed through the use of this option,
one of the options <samp>-l</samp> or <samp>-t</samp> is also selected, depending on
whether the string &lsquo;<samp>less</samp>&rsquo; appears in the pager&rsquo;s name or not.
</p>
<p>It is often useful to define &lsquo;<samp>wdiff</samp>&rsquo; as an alias for &lsquo;<samp>wdiff
-a</samp>&rsquo;.  However, this <em>hides</em> the normal <code>wdiff</code> behaviour.  The
default behaviour may be restored simply by piping the output from
<code>wdiff</code> through <code>cat</code>.  This dissociates the output from the
user&rsquo;s terminal.
</p>
</dd>
<dt><samp>--printer</samp></dt>
<dt><samp>-p</samp></dt>
<dd><p>Use over-striking to emphasize parts of the output.  Each character of the
deleted text is underlined by writing an underscore &lsquo;<samp>_</samp>&rsquo; first,
then a backspace and then the letter to be underlined.  Each character of the
inserted text is emboldened by writing it twice, with a backspace in
between.  This option is not selected by default.
</p>
</dd>
<dt><samp>--less-mode</samp></dt>
<dt><samp>-l</samp></dt>
<dd><p>Use over-striking to emphasize parts of output.  This option works as
option <samp>-p</samp>, but also over-strikes whitespace associated with
inserted text.  <code>less</code> shows such whitespace using reverse video.
This option is not selected by default.  However, it is automatically
turned on whenever <code>wdiff</code> launches the pager <code>less</code>.  See
option <samp>-a</samp>.
</p>
<p>This option is commonly used in conjunction with <code>less</code>:
</p>
<div class="example">
<pre class="example">wdiff -l <var>old_file</var> <var>new_file</var> | less
</pre></div>

</dd>
<dt><samp>--terminal</samp></dt>
<dt><samp>-t</samp></dt>
<dd><p>Force the production of <code>termcap</code> strings for emphasising parts of
output, even if the standard output is not associated with a terminal.
The <code>TERM</code> environment variable must contain the name of a valid
<code>termcap</code> entry.  If the terminal description permits, underlining
is used for marking deleted text, while bold or reverse video is used
for marking inserted text.  This option is not selected by default.
However, it is automatically turned on whenever <code>wdiff</code> launches a
pager, and it is known that the pager is <em>not</em> <code>less</code>.  See
option <samp>-a</samp>.
</p>
<p>This option is commonly used when <code>wdiff</code> output is not redirected,
but sent directly to the user terminal, as in:
</p>
<div class="example">
<pre class="example">wdiff -t <var>old_file</var> <var>new_file</var>
</pre></div>

<p>A common kludge uses <code>wdiff</code> together with the pager <code>more</code>,
as in:
</p>
<div class="example">
<pre class="example">wdiff -t <var>old_file</var> <var>new_file</var> | more
</pre></div>

<p>However, some versions of <code>more</code> use <code>termcap</code> emphasis for
their own purposes, so strange interactions are possible.
</p>
</dd>
<dt><samp>--start-delete <var>argument</var></samp></dt>
<dt><samp>-w <var>argument</var></samp></dt>
<dd><p>Use <var>argument</var> as the <em>start delete</em> string.  This string will
be output prior to any sequence of deleted text, to mark where it
starts.  By default, no start delete string is used unless there is no
other means of distinguishing where such text starts; in this case the
default start delete string is &lsquo;<samp>[-</samp>&rsquo;.
</p>
</dd>
<dt><samp>--end-delete <var>argument</var></samp></dt>
<dt><samp>-x <var>argument</var></samp></dt>
<dd><p>Use <var>argument</var> as the <em>end delete</em> string.  This string will be
output after any sequence of deleted text, to mark where it ends.  By
default, no end delete string is used unless there is no other means of
distinguishing where such text ends; in this case the default end delete
string is <samp>-]</samp>.
</p>
</dd>
<dt><samp>--start-insert <var>argument</var></samp></dt>
<dt><samp>-y <var>argument</var></samp></dt>
<dd><p>Use <var>argument</var> as the <em>start insert</em> string.  This string will
be output prior to any sequence of inserted text, to mark where it
starts.  By default, no start insert string is used unless there is no
other means of distinguishing where such text starts; in this case the
default start insert string is &lsquo;<samp>{+</samp>&rsquo;.
</p>
</dd>
<dt><samp>--end-insert <var>argument</var></samp></dt>
<dt><samp>-z <var>argument</var></samp></dt>
<dd><p>Use <var>argument</var> as the <em>end insert</em> string.  This string will be
output after any sequence of inserted text, to mark where it ends.  By
default, no end insert string is used unless there is no other means of
distinguishing where such text ends; in this case the default end insert
string is &lsquo;<samp>+}</samp>&rsquo;.
</p>
</dd>
<dt><samp>--avoid-wraps</samp></dt>
<dt><samp>-n</samp></dt>
<dd><p>Avoid spanning the end of line while showing deleted or inserted text.
Any single fragment of deleted or inserted text spanning many lines will
be considered as being made up of many smaller fragments not containing
a newline.  So deleted text, for example, will have an end delete string
at the end of each line, just before the new line, and a start delete
string at the beginning of the next line.  A long paragraph of inserted
text will have each line bracketed between start insert and end insert
strings.  This behaviour is not selected by default.
</p>
</dd>
<dt><samp>--diff-input</samp></dt>
<dt><samp>-d</samp></dt>
<dd><p>Use single unified diff as input. If no input file is specified,
standard input is used instead. This can be used to post-process diffs
generated form other applications, like version control systems:
</p>
<div class="example">
<pre class="example">svn diff | wdiff -d
</pre></div>
</dd>
</dl>

<p>Note that options <samp>-p</samp>, <samp>-t</samp>, and <samp>-[wxyz]</samp> are not
mutually exclusive.  If you use a combination of them, you will merely
accumulate the effect of each.  Option <samp>-l</samp> is a variant of option
<samp>-p</samp>.
</p>
<hr>
<a name="wdiff-Examples"></a>
<div class="header">
<p>
Previous: <a href="#wdiff-invocation" accesskey="p" rel="prev">wdiff invocation</a>, Up: <a href="#wdiff" accesskey="u" rel="up">wdiff</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Actual-examples-of-wdiff-usage"></a>
<h3 class="section">2.2 Actual examples of <code>wdiff</code> usage</h3>

<p>This section presents a few examples of usage, most of them have been
contributed by <code>wdiff</code> users.
</p>
<ul>
<li> Change bars example.

<ul>
<li> This example comes from a discussion with
<a href="mailto:jbw@cs.bu.edu">Joe Wells</a>.

<p>The following command produces a copy of <var>new_file</var>, shifted right
one space to accommodate change bars since the last revision, ignoring
those changes coming only from paragraph refilling.  Any line with new
or changed text will get a &lsquo;<samp>|</samp>&rsquo; in column 1.  However, deleted text
is not shown nor marked.
</p>
<div class="example">
<pre class="example">wdiff -1n <var>old_file</var> <var>new_file</var> |
  sed -e 's/^/  /;/{+/s/^ /|/;s/{+//g;s/+}//g'
</pre></div>

<p>Here is how it works.  Word differences are found, paying attention only
to additions, as requested by option <samp>-1</samp>.  For bigger changes
which span line boundaries, the insert bracket strings are repeated on
each output line, as requested by option <samp>-n</samp>.  This output is then
reformatted with a <code>sed</code> script which shifts the text right two
columns, turns the initial space into a bar only if there is some new
text on that line, then removes all insert bracket strings.
</p>
</li></ul>

</li><li> LaTeX example.

<ul>
<li> 
This example has been provided by
<a href="mailto:fisk@polar.bowdoin.edu">Steve Fisk</a>.

<p>The following uses LaTeX to put deleted text in boxes, and new text
in double boxes:
</p>
<div class="example">
<pre class="example">wdiff -w &quot;\fbox{&quot; -x &quot;}&quot; -y &quot;\fbox{\fbox{&quot; -z &quot;}}&quot; &hellip;
</pre></div>

<p>works nicely.
</p>
</li></ul>

</li><li> <code>troff</code> example.

<ul>
<li> This example comes from <a href="mailto:pgf@cayman.com">Paul Fox</a>.

<p>Using <code>wdiff</code>, with some <code>troff</code>-specific delimiters gives
<em>much</em> better output.  The delimiters I used:
</p>
<div class="example">
<pre class="example">wdiff -w'\s-5' -x'\s0' -y'\fB' -z'\fP' &hellip;
</pre></div>

<p>This makes the pointsize of deletions 5 points smaller than normal, and
emboldens insertions.  Fantastic!
</p>
<p>I experimented with:
</p>
<div class="example">
<pre class="example">wdiff -w'\fI' -x'\fP' -y'\fB' -z'\fP'
</pre></div>

<p>since that&rsquo;s more like the defaults you use for terminals or printers,
but since I actually use italics for emphasis in my documents, I thought
the point size thing was clearer.
</p>
<p>I tried it on code, and it works surprisingly well there, too...
</p>
</li><li> <a href="mailto:leisner@eso.mc.xerox.com">Marty Leisner</a> says:

<p>In the previous example, you had smaller text being taken out and bold
face inserted.  I had smaller text being taken out and larger text being
inserted, I&rsquo;m using bold face for other things, so this is more clear.
</p>
<div class="example">
<pre class="example">wdiff -w '\s-3' -x'\s0' -y'\s+3' -z'\s0'
</pre></div>

</li></ul>

</li><li> Colored output example.

<ul>
<li> This example comes from <a href="mailto:Martin.vGagern@gmx.net">Martin von Gagern</a>.

<p>If you like colored output, and your terminal supports ANSI escape
sequences, you can use this invocation:
</p>
<div class="example">
<pre class="example">wdiff -n \
  -w $'\033[30;41m' -x $'\033[0m' \
  -y $'\033[30;42m' -z $'\033[0m' \
  &hellip; | less -R
</pre></div>

<p>This will print deleted text black on red, and inserted text black on
green, assuming that your normal terminal colors are white on black.
Of course you can choose different colors if you prefer.
</p>
<p>The &lsquo;<samp>$'&hellip;'</samp>&rsquo; notation is supported by GNU bash, and maybe other
shells as well. If your shell doesn&rsquo;t support it, you might need some
more tricks to generate these escape sequences as command line
arguments.
</p>
</li></ul>

</li></ul>

<p>On a related note, GNU Emacs users might notice that the interactive
function <code>compare-windows</code> ignores changes in whitespace, if it is
given a numeric argument.  If the variable <code>compare-ignore-case</code>
is non-<code>nil</code>, it ignores differences in case as well.  So, in a way,
this offers a kind of incremental version of <code>wdiff</code>.
</p>

<hr>
<a name="mdiff"></a>
<div class="header">
<p>
Next: <a href="#unify" accesskey="n" rel="next">unify</a>, Previous: <a href="#wdiff" accesskey="p" rel="prev">wdiff</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="The-multi_002ddifference-finder"></a>
<h2 class="chapter">3 The multi-difference finder</h2>

<p>The name <code>mdiff</code> stands for <em>multi-</em><code>diff</code>, and has the
purpose of encompassing the functionnality of a few other <code>diff</code>-type
programs.  The prefix <em>multi-</em> also stands for the fact the program
is often able to study more than two input files at once.
</p>
<p>The theory of operation is simple.  The program splits all input files
into a sequence of items, which may be lines or words.  <code>mdiff</code> is
then said to operate either in <em>line mode</em> or in <em>word mode</em>.
It then tries to find sequences of items which are repeated in the
input files.  Such common sequences are called <em>clusters</em> of items,
and each occurrence of a repetition is called a cluster <em>member</em>.
What remains, once all cluster members are conceptually removed from all
input files, is a set of <em>differences</em>.  The role of <code>mdiff</code>
is to conveniently list either cluster members and differences.
</p>
<p>When input files are very similar, it is likely that clusters will
encompass many items (lines or words) and differences will be small.  So,
most listing options inhibit the printing of cluster members.  However,
one may ask for the few beginning or ending items of cluster members
to be printed nevertheless, as a way to provide a kind of feedback
or <em>context</em> of the difference, those context items are sometimes
said to be at the <em>horizon</em> of the difference.  In merged listings,
cluster members may just not be printed, except maybe for a few context
items at the beginning of the member (just after a difference), and a
few context items at the end of the member (just before a difference).
</p>
<p>When cluster members are short, or if you prefer, when the differences
are not far away from each other, it is quite possible that the required
context items often cover the full extent of the cluster members, which
then are not inhibited anymore when this happens.  A run of differences
intermixed with such non-suppressed members is called a <em>hunk</em>.
Some reports produced by <code>mdiff</code> are showned as a list of hunks,
and it is to be understood that common items are elided between hunks.
However, each hunk in itself has no item missing, and each item of the
hunk is analysed as pertaining either to only one of the input file or
to many of them.  Each hunk is preceded by a header, which explains the
line position of all input files prior to the hunk itself.  By comparing
a hunk header with the previous hunk header, the user can have a hint
about how much printing was spared.
</p>
<p>When two input files are quite similar, clusters are usually presented in
the same order in all files.  If a cluster member <var>A</var> in the first
file corresponds to a cluster member <var>A</var> in the second file, it is
likely that another cluster member <var>B</var> which appears <em>after</em>
<var>A</var> in the first file will correspond to a cluster member <var>B</var>
in the second file which appears <em>after</em> <var>A</var> as well.  So, in
many cases, while producing merged listing of files, cluster members may
be made to naturally correspond to one another.  However, this is not
always true, in particular when the second file has been produced from
the first by moving a big chunk of code away from its original position.
In such cases, we say that members have <em>crossed</em>.  When members are
crossed and <code>mdiff</code> has to make a merged listing, it selects one
cluster member as being <em>naturally</em> associated with its correspondant
(either the pair of <var>A</var>&rsquo;s or the pair of <var>B</var>&rsquo;s) and then consider
the other cluster as being part of a difference.  The crossed nature of
the member may still be analysed and reported, or it may be ignored.
</p>
<p>The standard <code>diff</code> program is meant for when there are exactly two
input files, for which crossed members should be ignored.  <code>mdiff</code>
output format has been designed in such a way that it should resemble
<code>diff</code> output for this precise case.  However, <code>diff</code> formats are
not sufficient for representing all cases which <code>mdiff</code> may address,
and this is not mature yet.  That is why <code>mdiff</code>, in its current
state, still experiments with output formats, which are subject to change.
</p>
<p>When the input files are not very similar, or rather different, merged
listings are not very significant nor useful, and may even be rather
confusing.  The best to do in such cases is using <code>mdiff</code> for making
an annotated relisting of all input files, in which cluster members are
properly identified and referred to one another.
</p>
<p>Statistics.
</p>
<div class="example">
<pre class="example">Read summary: 137 files, 41975 lines
Work summary: 439 clusters, 1608 members, 8837 duplicate lines
</pre></div>

<p>The summary lines, triggered by the <samp>-s</samp> option, say that about 8837
non-ignorable lines could be removed over the 41975 which has been read,
by using functions, <code>#include</code>, <code>#define</code>, or similar devices.
</p>
<p>If one manages to execute <code>mdiff</code> within GNU Emacs so the output
described above is collected into the <code>*compilation*</code> buffer, the
command <kbd>C-`</kbd> (&lsquo;<samp><span class="nolinebreak">M-x</span>&nbsp;<span class="nolinebreak">next-error</span><!-- /@w --></samp>&rsquo;) will proceed to the next
cluster member in the other window, and similarily for other compilation
mode commands.  This is a useful way for handling <code>mdiff</code> output.
</p>
<p>Each line in the hunk, after the header, comes from the compared files,
but is shifted right so the first column (or the first few columns)
of each line gives information about where the line is coming from.
A space indicates a line which is common to all files.  In case there
are only two input files, a minus sign indicates a line from the first
file and a plus sign a line from the second file.  Else, a letter from
&lsquo;<samp>a</samp>&rsquo; to &lsquo;<samp>z</samp>&rsquo;, or more than one letter if there are more than
26 files, indicates to which file the line pertains.  If a line or a
block of line pertains to many files but not to all of them, the first
column holds a vertical bar, and the line or block of lines is bracketed
between &lsquo;<samp>@/</samp>&rsquo; and &lsquo;<samp>@\</samp>&rsquo; lines, which are kind of comments within
the hunk.  The initial bracket lists all file letters that are related
to the incoming line.
</p>
<p>I initially wrote <code>mdiff</code> specifically to help cleaning a C++
project which was a bit large, and in which many big monolithic classes
were derived from each other most probably by rough copying followed by
local modifications.  I intended to fragment most common clusters and
segregate the parts into virtual methods in outer classes, and override
these methods, as appropriate, with less common variants within inner
classes.  <code>mdiff</code> was good at pointing me to exactly where I should
look at.  Of course, it never did the cleanup for me, but it helped doing
the research about what should be done.  Reusing <code>mdiff</code> over the
half-cleaned project gave me more fine grained analysis of what was left
to consider.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#mdiff-invocation" accesskey="1">mdiff invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Invoking <code>mdiff</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Efficiency" accesskey="2">Efficiency</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Resource considerations and efficiency
</td></tr>
</table>

<hr>
<a name="mdiff-invocation"></a>
<div class="header">
<p>
Next: <a href="#Efficiency" accesskey="n" rel="next">Efficiency</a>, Up: <a href="#mdiff" accesskey="u" rel="up">mdiff</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Invoking-mdiff"></a>
<h3 class="section">3.1 Invoking <code>mdiff</code></h3>

<p>The format for running the <code>mdiff</code> program is:
</p>
<div class="example">
<pre class="example">mdiff <var>option</var> &hellip; <var>file</var> &hellip;
</pre></div>

<p><code>mdiff</code> read all input <var>file</var>s and produces its results on
standard output.  Optionally, standard error might receive a progress
report or a few statistics.
</p>
<p><code>wdiff</code> compares files <var>old_file</var> and <var>new_file</var> and
produces an annotated copy of <var>new_file</var> on standard output.  The
empty string or the string <samp>-</samp> denotes standard input, but standard
input cannot be used twice in the same invocation.  The complete path of
a file should be given, a directory name is not accepted.  <code>wdiff</code>
will exit with a status of 0 if no differences were found, a status of 1
if any differences were found, or a status of 2 for any error.
</p>
<p>In this documentation, <em>deleted text</em> refers to text in
<var>old_file</var> which is not in <var>new_file</var>, while <em>inserted text</em>
refers to text on <var>new_file</var> which is not in <var>old_file</var>.
</p>
<p><code>mdiff</code> supports the following command line options:
</p>
<dl compact="compact">
<dt><samp>--version</samp></dt>
<dd><p>Merely prints the version numbers on standard output, and exits without
doing anything else.
</p>
</dd>
<dt><samp>--help</samp></dt>
<dd><p>Merely prints a page of help on standard output, and exits without doing
anything else.
</p>
</dd>
<dt><samp>--no-deleted</samp></dt>
<dt><samp>-1</samp></dt>
<dd><p>Avoid producing deleted words on the output.  If neither <samp>-1</samp> or
<samp>-2</samp> is selected, the original right margin may be exceeded for
some lines.
</p>
</dd>
<dt><samp>--no-inserted</samp></dt>
<dt><samp>-2</samp></dt>
<dd><p>Avoid producing inserted words on the output.  When this flag is given,
the whitespace in the output is taken from <var>old_file</var> instead of
<var>new_file</var>.  If neither <samp>-1</samp> or <samp>-2</samp> is selected, the
original right margin may be exceeded for some lines.
</p>
</dd>
<dt><samp>--no-common</samp></dt>
<dt><samp>-3</samp></dt>
<dd><p>Avoid producing common words on the output.  When this option is not
selected, common words and whitespace are taken from <var>new_file</var>,
unless option <samp>-2</samp> is given, in which case common words and
whitespace are rather taken from <var>old_file</var>.  When selected,
differences are separated from one another by lines of dashes.
Moreover, if this option is selected at the same time as <samp>-1</samp> or
<samp>-2</samp>, then none of the output will have any emphasis, i.e. no bold
or underlining.  Finally, if this option is not selected, but both
<samp>-1</samp> and <samp>-2</samp> are, then sections of common words between
differences are segregated by lines of dashes.
</p>
</dd>
<dt><samp>--ignore-case</samp></dt>
<dt><samp>-i</samp></dt>
<dd><p>Do not consider case difference while comparing words.  Each lower case
letter is seen as identical to its upper case equivalent for the purpose
of deciding if two words are the same.
</p>
</dd>
<dt><samp>--auto-pager</samp></dt>
<dt><samp>-A</samp></dt>
<dd><p>Some initiatives which were previously automatically taken in previous
versions of <code>wdiff</code> are now put under the control of this option.
By using it, a pager is interposed whenever the <code>wdiff</code> output is
directed to the user&rsquo;s terminal.  Without this option, no pager will be
called, the user is then responsible for explicitly piping <code>wdiff</code>
output into a pager, if required.
</p>
<p>The pager is selected by the value of the <var>PAGER</var> environment
variable when <code>wdiff</code> is run.  If <var>PAGER</var> is not defined at
run time, then a default pager, selected at installation time, will be
used instead.  A defined but empty value of <var>PAGER</var> means no pager
at all.
</p>
<p>When a pager is interposed through the use of this option,
one of the options <samp>-l</samp> or <samp>-t</samp> is also selected, depending on
whether the string &lsquo;<samp>less</samp>&rsquo; appears in the pager&rsquo;s name or not.
</p>
<p>It is often useful to define &lsquo;<samp>wdiff</samp>&rsquo; as an alias for &lsquo;<samp>wdiff
-a</samp>&rsquo;.  However, this <em>hides</em> the normal <code>wdiff</code> behaviour.  The
default behaviour may be restored simply by piping the output from
<code>wdiff</code> through <code>cat</code>.  This dissociates the output from the
user&rsquo;s terminal.
</p>
</dd>
<dt><samp>--printer</samp></dt>
<dt><samp>-p</samp></dt>
<dd><p>Use over-striking to emphasize parts of the output.  Each character of the
deleted text is underlined by writing an underscore &lsquo;<samp>_</samp>&rsquo; first,
then a backspace and then the letter to be underlined.  Each character of the
inserted text is emboldened by writing it twice, with a backspace in
between.  This option is not selected by default.
</p>
</dd>
<dt><samp>--less-mode</samp></dt>
<dt><samp>-l</samp></dt>
<dd><p>Use over-striking to emphasize parts of output.  This option works as
option <samp>-p</samp>, but also over-strikes whitespace associated with
inserted text.  <code>less</code> shows such whitespace using reverse video.
This option is not selected by default.  However, it is automatically
turned on whenever <code>wdiff</code> launches the pager <code>less</code>.  See
option <samp>-a</samp>.
</p>
<p>This option is commonly used in conjunction with <code>less</code>:
</p>
<div class="example">
<pre class="example">wdiff -l <var>old_file</var> <var>new_file</var> | less
</pre></div>

</dd>
<dt><samp>--terminal</samp></dt>
<dt><samp>-t</samp></dt>
<dd><p>Force the production of <code>termcap</code> strings for emphasising parts of
output, even if the standard output is not associated with a terminal.
The &lsquo;<samp>TERM</samp>&rsquo; environment variable must contain the name of a valid
<code>termcap</code> entry.  If the terminal description permits, underlining
is used for marking deleted text, while bold or reverse video is used
for marking inserted text.  This option is not selected by default.
However, it is automatically turned on whenever <code>wdiff</code> launches a
pager, and it is known that the pager is <em>not</em> <code>less</code>.  See
option <samp>-a</samp>.
</p>
<p>This option is commonly used when <code>wdiff</code> output is not redirected,
but sent directly to the user terminal, as in:
</p>
<div class="example">
<pre class="example">wdiff -t <var>old_file</var> <var>new_file</var>
</pre></div>

<p>A common kludge uses <code>wdiff</code> together with the pager <code>more</code>,
as in:
</p>
<div class="example">
<pre class="example">wdiff -t <var>old_file</var> <var>new_file</var> | more
</pre></div>

<p>However, some versions of <code>more</code> use <code>termcap</code> emphasis for
their own purposes, so strange interactions are possible.
</p>
</dd>
<dt><samp>--start-delete <var>argument</var></samp></dt>
<dt><samp>-w <var>argument</var></samp></dt>
<dd><p>Use <var>argument</var> as the <em>start delete</em> string.  This string will
be output prior to any sequence of deleted text, to mark where it
starts.  By default, no start delete string is used unless there is no
other means of distinguishing where such text starts; in this case the
default start delete string is &lsquo;<samp>[-</samp>&rsquo;.
</p>
</dd>
<dt><samp>--end-delete <var>argument</var></samp></dt>
<dt><samp>-x <var>argument</var></samp></dt>
<dd><p>Use <var>argument</var> as the <em>end delete</em> string.  This string will be
output after any sequence of deleted text, to mark where it ends.  By
default, no end delete string is used unless there is no other means of
distinguishing where such text ends; in this case the default end delete
string is <samp>-]</samp>.
</p>
</dd>
<dt><samp>--start-insert <var>argument</var></samp></dt>
<dt><samp>-y <var>argument</var></samp></dt>
<dd><p>Use <var>argument</var> as the <em>start insert</em> string.  This string will
be output prior to any sequence of inserted text, to mark where it
starts.  By default, no start insert string is used unless there is no
other means of distinguishing where such text starts; in this case the
default start insert string is &lsquo;<samp>{+</samp>&rsquo;.
</p>
</dd>
<dt><samp>--end-insert <var>argument</var></samp></dt>
<dt><samp>-z <var>argument</var></samp></dt>
<dd><p>Use <var>argument</var> as the <em>end insert</em> string.  This string will be
output after any sequence of inserted text, to mark where it ends.  By
default, no end insert string is used unless there is no other means of
distinguishing where such text ends; in this case the default end insert
string is &lsquo;<samp>+}</samp>&rsquo;.
</p>
</dd>
<dt><samp>--avoid-wraps</samp></dt>
<dt><samp>-n</samp></dt>
<dd><p>Avoid spanning the end of line while showing deleted or inserted text.
Any single fragment of deleted or inserted text spanning many lines will
be considered as being made up of many smaller fragments not containing
a newline.  So deleted text, for example, will have an end delete string
at the end of each line, just before the new line, and a start delete
string at the beginning of the next line.  A long paragraph of inserted
text will have each line bracketed between start insert and end insert
strings.  This behaviour is not selected by default.
</p>
</dd>
</dl>

<p>Some choices are hard-wired into the program, but might well become options
in later releases.  For example:
</p>
<ul>
<li> No cluster may span a file boundary, that is, start near the end of one
input file and continue at the beginning of the next file.

</li><li> A cluster may have many members from the same file.

</li><li> White space is ignored between the beginning of a line and the first
non-white character.

</li><li> White space is significant when embedded in a line, or when ending a line.

</li><li> Lines having no significant part (only white lines for now) are
<em>ignorable</em>.  Such ignorable lines are logically considered as not
being part of the input files for the sake of comparisons.

</li><li> Comments from the C language are not especially ignored.  Unless ignored
for other reasons (being white lines), they are indeed significant lines.

</li><li> No cluster member may ever directly start nor end with ignorable lines.
However, ignorable lines may still be embedded within a cluster member.

</li><li> In the generated output, clusters containing the biggest number of
ignorable lines are output first, while smaller clusters appear last.
All lines pertaining to a single cluster are output together.  Within a
cluster, members are listed in the order of the initial reading of
input files.

</li></ul>

<p>Note that options <samp>-p</samp>, <samp>-t</samp>, and <samp>-[wxyz]</samp> are not
mutually exclusive.  If you use a combination of them, you will merely
accumulate the effect of each.  Option <samp>-l</samp> is a variant of option
<samp>-p</samp>.
</p>
<hr>
<a name="Efficiency"></a>
<div class="header">
<p>
Previous: <a href="#mdiff-invocation" accesskey="p" rel="prev">mdiff invocation</a>, Up: <a href="#mdiff" accesskey="u" rel="up">mdiff</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Resource-considerations-and-efficiency"></a>
<h3 class="section">3.2 Resource considerations and efficiency</h3>

<dl compact="compact">
<dt>Memory consumption</dt>
<dd>
<p><code>mdiff</code> can easily handle medium-sized project.  For a 32 bits
architecture, the memory requirements may computed like this:
</p>
<ul>
<li> 8 bytes per file
</li><li> 8 bytes per line
</li><li> 4 bytes per cluster
</li><li> 8 bytes per cluster member
</li></ul>

</dd>
<dt>Time consumption</dt>
<dd>
<p>To evaluate the speed, consider the example shown above
(see <a href="#mdiff">mdiff</a>), and yielding these statistics:
</p>
<div class="example">
<pre class="example">Read summary: 137 files, 41975 lines
Work summary: 439 clusters, 1608 members &hellip;
</pre></div>

<p>Once many files in the memory cache, and redirecting the output to
<samp>/dev/null</samp>, the processing takes 3 seconds of real time on an
Intel 486/100, which looks good.  I was indeed afraid of some hidden
O(<var>n</var>^2) behaviour<a name="DOCF1" href="#FOOT1"><sup>1</sup></a>,
even if the program is mostly O(<var>n</var>*log(<var>n</var>)).  Maybe one will
discover or construct cases putting <code>mdiff</code> on its knees.  So far,
<code>mdiff</code> seemingly behaves well for the little problems given to it.
If we devise and generate a more traditional <code>diff</code>-like output,
in which all input files are relisted, this will add some time to the
processing, but it will be only linear with regard with the total length
of input files.
</p>
<p>There is a clever optimized sorting algorithm for <em>all</em> substrings
of a file, which might be generalised to handle words or lines for
<code>mdiff</code>.  But since the program is already faster than we initially
expected, there is no emergency to resort to using such an algorithm.
</p>
</dd>
<dt>Trading complexity for clarity</dt>
<dd>
<p>When lines repeat a lot, there are surprisingly many ways to relate blocks
of lines, and reporting them <em>all</em> can make very hairy listings.
Any choice about reporting similarities, or not, is somewhat arbitrary,
but we ought to make some of such choices for the program to be practical.
Some of these choices are detailed here.
</p>
<p>If all members of a given cluster <var>A</var> are proper subsets of all
members of another given cluster <var>B</var>, then cluster <var>A</var> is wholly
forgotten.  However, let&rsquo;s presume for example that there are more members
in <var>A</var> than in <var>B</var>.  Then, some members of <var>A</var> necessarily
appear unrelated to any member of <var>B</var>.  In such case, it has been
decided more useful to report <em>all</em> occurrences of <var>A</var> members,
even those embedded within occurrences of <var>B</var> members.  When only
interested in members <var>B</var>, annotations pertaining to <var>A</var> may be
perceived as clutter.  However, when interested in members of <var>A</var>,
getting all of them is probably the most useful choice.
</p>
<p>It sometimes happen that members of a very same cluster overlap.  In the
string &lsquo;<samp>a&nbsp;a&nbsp;a<!-- /@w --></samp>&rsquo;, there are two overlapping members for the cluster
represented by the string &lsquo;<samp>a&nbsp;a<!-- /@w --></samp>&rsquo;, one from the first two &lsquo;<samp>a</samp>&rsquo;,
another from the last two &lsquo;<samp>a</samp>&rsquo;.  In such cases, one member of such
an overlap is automatically chopped so the overlap does not occur.
</p>
<p>White lines and items containing only delimiters are the possible source of
a lot of complexity, if these are fully taken as significant.  Since this
does not add much to clarity, they are better ignored, usually, through
using <samp>--ignore-blank-lines</samp> (<samp>-B</samp>) or <samp>--ignore-delimiters</samp>
(<samp>-j</samp>).  Increasing the value of <samp>--minimum-size=<var>items</var></samp>
(&lsquo;<samp><span class="nolinebreak">-J</span>&nbsp;<var>items</var><!-- /@w --></samp>&rsquo;) option also cut off complexity in favor of
clarity, yet some small matches may then go unnoticed.  Exactly how to
best adjust the <var>items</var> value is left for the user to decide.
</p>
</dd>
</dl>

<hr>
<a name="unify"></a>
<div class="header">
<p>
Next: <a href="#Compatibility" accesskey="n" rel="next">Compatibility</a>, Previous: <a href="#mdiff" accesskey="p" rel="prev">mdiff</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="The-diff-format-converter"></a>
<h2 class="chapter">4 The diff format converter</h2>

<p>The program <code>unify</code> has the purpose of manipulating context diffs
and unified context diffs.  <code>unify</code> will accept either a regular
context diff (old- or new-style) or a unified context diff as input,
and generate either a unified diff or a new-style context diff as output.
</p>
<p>Various other options allow you to echo the non-diff (comment) lines to
stderr, modify the diff by removing the comment lines, and/or tweak the
diff into a format that is good for releasing patches.
</p>
<p>I think most people prefer unified context diffs in general.  But some
of us just have trouble reading unidiffs, unless they get very simple.
Usual context diffs show how the code was <em>before</em>, and then, how
the code is <em>after</em>.  Some people just prefer understanding twice
thoroughly, than once fuzzily.  The tool is useful for those who handle
a lot of diffs from various sources, and want them in a uniform format.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#unify-invocation" accesskey="1">unify invocation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Invoking <code>unify</code>
</td></tr>
</table>

<hr>
<a name="unify-invocation"></a>
<div class="header">
<p>
Up: <a href="#unify" accesskey="u" rel="up">unify</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Invoking-unify"></a>
<h3 class="section">4.1 Invoking <code>unify</code></h3>

<p>The format for running the <code>unify</code> program is:
</p>
<div class="example">
<pre class="example">unify <var>option</var> &hellip; [<var>file</var>]
</pre></div>

<p>The program reads the diff to convert from <var>file</var>, or if the
source file is not mentioned, it will be read from the standard input.
The default is to output the diff in the opposite style of whatever was
input, that is, regular context diffs will become unified context diffs,
and unified context diffs will become unified context diffs, but this
can be overridden by options.
</p>
<p><code>unify</code> supports the following command line options:
</p>
<dl compact="compact">
<dt><samp>--version</samp></dt>
<dd><p>Merely prints the version numbers on standard output, and exits without
doing anything else.
</p>
</dd>
<dt><samp>--help</samp></dt>
<dd><p>Merely prints a page of help on standard output, and exits without doing
anything else.
</p>
</dd>
<dt><samp>--context-diffs</samp></dt>
<dt><samp>-c</samp></dt>
<dd><p>Forces context diff output.
</p>
</dd>
<dt><samp>--echo-comments</samp></dt>
<dt><samp>-e</samp></dt>
<dd><p>Echoes non-diff (comment) lines to stderr.  If a comment line is
being stripped via the <samp>-p</samp> option, it is echoed with a preceding
&lsquo;<samp>!!! </samp>&rsquo;.  If all comments are being stripped (via the <samp>-s</samp>
option), no special designation is given.
</p>
</dd>
<dt><samp>--old-diffs</samp></dt>
<dt><samp>-o</samp></dt>
<dd><p>Is used to force a context diff to be interpreted as being of the
old-style even if it has the extra trailing asterisks that normally mark
the new-style.  This is only needed if <code>unify</code> fails to work with
your version of <code>diff</code>.
</p>
</dd>
<dt><samp>--patch-format</samp></dt>
<dt><samp>-p</samp></dt>
<dd><p>Turns on patch-output mode.  This will do two things:
</p>
<ol>
<li> Transform a header like:

<div class="example">
<pre class="example">*** orig/file	Sat May  5 02:59:37 1990
--- ./file	Sat May  5 03:00:08 1990
</pre></div>

<p>into a line of &lsquo;<samp>Index: file</samp>&rsquo; &mdash; we choose the shorter name and strip
a leading &lsquo;<samp>./</samp>&rsquo; sequence if present.
</p>
</li><li> Strip lines that begin with &lsquo;<samp>Only&nbsp;in&nbsp;<!-- /@w --></samp>&rsquo;, &lsquo;<samp>Common&nbsp;subdir<!-- /@w --></samp>&rsquo;,
&lsquo;<samp>Binary&nbsp;files<!-- /@w --></samp>&rsquo; or &lsquo;<samp>diff&nbsp;<span class="nolinebreak">-</span><!-- /@w --></samp>&rsquo;.

</li></ol>

</dd>
<dt><samp>-P</samp></dt>
<dd><p>Is the same as <samp>-p</samp>.
</p>
</dd>
<dt><samp>--strip-comments</samp></dt>
<dt><samp>-s</samp></dt>
<dd><p>Strips non-diff lines (comments).
</p>
</dd>
<dt><samp>--unidiffs</samp></dt>
<dt><samp>-u</samp></dt>
<dd><p>Forces unified diff output.
</p>
</dd>
<dt><samp>-U</samp></dt>
<dd><p>Is the same as <samp>-up</samp>.
</p>
</dd>
<dt><samp>--use-equals</samp></dt>
<dt><samp>-=</samp></dt>
<dd><p>Will use a &lsquo;<samp>=</samp>&rsquo; prefix in a unified diff for lines that are common
to both files instead of using a leading space.  Though this is harder to
read, it is less likely to be mangled by trailing-space-stripping sites
when posted to Usenet.
</p>
</dd>
</dl>

<hr>
<a name="Compatibility"></a>
<div class="header">
<p>
Next: <a href="#Experimental" accesskey="n" rel="next">Experimental</a>, Previous: <a href="#unify" accesskey="p" rel="prev">unify</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="How-mdiff-differs"></a>
<h2 class="chapter">5 How <code>mdiff</code> differs</h2>

<p>The GNU project already has a <code>diff</code> program which is part of the
GNU diffutils package.  There also are various non-GNU <code>diff</code>
programs provided by various constructors.
</p>
<p>There is also the well-established <code>wdiff</code> which uses
<code>diff</code> under the hood. It differs slightly from
<code>wdiff2</code>, its intended <code>mdiff</code>-based successor.
</p>
<p>The following sections compare <code>mdiff</code> specifications with both GNU
<code>diff</code> and with <code>wdiff</code>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#diff-Compatibility" accesskey="1">diff Compatibility</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Differences with <code>diff</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#wdiff-Compatibility" accesskey="2">wdiff Compatibility</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Differences with <code>wdiff</code>
</td></tr>
</table>

<hr>
<a name="diff-Compatibility"></a>
<div class="header">
<p>
Next: <a href="#wdiff-Compatibility" accesskey="n" rel="next">wdiff Compatibility</a>, Up: <a href="#Compatibility" accesskey="u" rel="up">Compatibility</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Differences-with-diff"></a>
<h3 class="section">5.1 Differences with <code>diff</code></h3>

<p>GNU <code>diff</code> is a program which matured for a long while, and for which
algorithms are based on computer science literature.  It is a fast program.
By comparison, <code>mdiff</code> is not more than a program kludged up rapidly
to satisfy a few precise needs.  It only tries not being inordinately slow.
</p>
<p>Most <code>diff</code> options are accepted by <code>mdiff</code> under the same
short and long option names, and is able to produce resembling output,
for making <code>mdiff</code> easier to learn and less surprising to users.
Yet, some differences exist in option decoding and output format.  Since
<code>diff</code> and <code>mdiff</code> use different matching algorithms, it is
very likely that the differences will not be exactly analyzed identically.
</p>
<ul>
<li> A few <code>diff</code> options, which either accept no argument or require
a mandatory one, are implemented in <code>mdiff</code> as options accepting
an optional argument.  This may yield some surprises, for example,
<samp>-c4bir</samp> would be accepted by <code>diff</code> and rejected by
<code>mdiff</code>, yet it may rewritten <samp>-birc4</samp> for both.  See below.

</li><li> Options <samp>-c</samp> and <samp>-u</samp> in <code>diff</code> ask for regular context
and unified context output, respectively, without specifying the number
of lines in the context.  <code>diff</code> has &lsquo;<samp><span class="nolinebreak">-C</span>&nbsp;<var>number</var><!-- /@w --></samp>&rsquo; and
&lsquo;<samp><span class="nolinebreak">-U</span>&nbsp;<var>number</var><!-- /@w --></samp>&rsquo; options for asking for regular or unified context
diffs with <var>number</var> context lines.  If <samp>-c4</samp> asks for four lines
of context, the &lsquo;<samp>4</samp>&rsquo; is not really an argument of <samp>-c</samp>, and this
is really interpreted as &lsquo;<samp><span class="nolinebreak">-c</span>&nbsp;<span class="nolinebreak">-4</span><!-- /@w --></samp>&rsquo;, where <samp>-<var>number</var></samp> is
meant to be a deprecated option for choosing the number of context lines,
option which <code>mdiff</code> does not implement.  In <code>mdiff</code>, <samp>-c</samp>
and <samp>-u</samp> are really two options which are allowed to receive an
optional argument, so the number of lines may, or may not be given, at
the choice of the user.  In <code>mdiff</code>, options <samp>-C</samp> and <samp>-U</samp>
are completely equivalent to <samp>-c</samp> and <samp>-u</samp>, and are provided
only for the sake of compatibility.

</li><li> Option <samp>-v</samp> in <code>diff</code> means <samp>--version</samp>, while it
means <samp>--verbose</samp> in <code>mdiff</code>.  There is no short form for
<samp>--version</samp> in <code>mdiff</code>.

</li></ul>

<hr>
<a name="wdiff-Compatibility"></a>
<div class="header">
<p>
Previous: <a href="#diff-Compatibility" accesskey="p" rel="prev">diff Compatibility</a>, Up: <a href="#Compatibility" accesskey="u" rel="up">Compatibility</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Differences-with-wdiff"></a>
<h3 class="section">5.2 Differences with <code>wdiff</code></h3>

<p>Even if <code>mdiff</code> is meant to fully support <code>wdiff</code>, options have
been shuffled around so <code>mdiff</code> could better merge both <code>diff</code>
and <code>wdiff</code> options in a common scheme.  <code>diff</code> habits were
almost always favored in this option reorganisation.
</p>
<p><code>wdiff2</code> is now a mere front-end to <code>mdiff</code> that only
rewrites the options.  The following notes apply.
</p>
<ul>
<li> Some options are just transmitted unchanged, these are <samp>-1</samp>,
<samp>-2</samp>, <samp>-3</samp> and <samp>-i</samp>.

</li><li> Option <samp>-c</samp> also gets turned into <samp>-i</samp>, to be compatible with
<code>wdiff</code> versions up to &lsquo;<samp>0.4</samp>&rsquo;.

</li><li> Simple option <samp>-a</samp> in <code>wdiff</code> becomes <samp>-A</samp> in <code>mdiff</code>,
<samp>-l</samp> becomes <samp>-k</samp>, <samp>-n</samp> becomes <samp>-m</samp>, <samp>-p</samp> becomes
<samp>-o</samp>, <samp>-s</samp> becomes <samp>-v</samp> and <samp>-t</samp> becomes <samp>-z</samp>.

</li><li> Options introducing strings, which are <samp>-w</samp>, <samp>-x</samp>, <samp>-y</samp>
and <samp>-z</samp> in <code>wdiff</code>, respectively become <samp>-Y</samp>, <samp>-Z</samp>,
<samp>-Q</samp> and <samp>-R</samp> in <code>mdiff</code>.

</li><li> Options <samp>-C</samp>, <samp>-h</samp> and <samp>-v</samp> are processed directly by
<code>wdiff</code> and are not transmitted to <code>mdiff</code>.

</li><li> Further, the <samp>-C</samp> option of <code>wdiff</code> has no equivalent in
<code>mdiff</code>.

</li><li> A new option <samp>-q</samp> inhibits the message which explains how <code>mdiff</code>
might have been directly called.

</li><li> The option <samp>--diff-input</samp> (<samp>-d</samp>) from <code>wdiff</code>
isn&rsquo;t supported by <code>wdiff2</code> (yet).

</li></ul>


<hr>
<a name="Experimental"></a>
<div class="header">
<p>
Previous: <a href="#Compatibility" accesskey="p" rel="prev">Compatibility</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Experimental-programs"></a>
<h2 class="chapter">6 Experimental programs</h2>

<p>The GNU wdiff source package contains sources for a number of tools
besides <code>wdiff</code> itself.
These are considered experimental: they might work for you, but they
might just as well fail.
The following programs are considered experimental:
</p>
<ul>
<li> <code>mdiff</code>
</li><li> <code>wdiff2</code>
</li><li> <code>unify</code>
</li></ul>

<p>Building these applications can be configured at build time by passing
<samp>--with-experimental</samp> to the <samp>configure</samp> script.
</p>
<p><em>For this build, they have been enabled.</em>
If you encounter a bug in an experimental program, the maintainers would
still like to learn about it, but there is a greater chance that they
decide not to fix such issues unless you provide a patch as well.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Experimental-History" accesskey="1">Experimental History</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">History of the experimental programs
</td></tr>
</table>

<hr>
<a name="Experimental-History"></a>
<div class="header">
<p>
Up: <a href="#Experimental" accesskey="u" rel="up">Experimental</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="History-of-the-Experimental-programs"></a>
<h3 class="section">6.1 History of the Experimental programs</h3>

<p>Many users
suggested features, which were in turn inviting for the integration of
<code>wdiff</code> into GNU diffutils.  Collaboration proved to be rather
difficult.  After a few years, the <code>wdiff</code> author finally gave in
and created <code>mdiff</code> as a way to break out of the situation and for
becoming able to proceed with users&rsquo; suggestions.
</p>
<p>Before <code>mdiff</code> and the new <code>wdiff2</code> based on it were
officially released, the original author resigned maintainership.
The new maintainers had little experience with the code, and therefore
decided to mark it experimental. That way, the code wouldn&rsquo;t be lost,
but it would be clear that it wasn&rsquo;t as testes as the good old
<code>wdiff</code> command.
</p>

<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT1" href="#DOCF1">(1)</a></h3>
<p><var>n</var> is the total number of lines.</p>
</div>
<hr>



</body>
</html>
